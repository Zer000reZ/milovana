(this["webpackJsonpeos-host"]=this["webpackJsonpeos-host"]||[]).push([[5],{202:function(t,e,o){"use strict";o.r(e);var i=o(1),n=o.n(i),A=o(5),s=o(2),r=o(3),u=o(185),a=o(103),c=o(16),h=o.n(c),p=h()("eos:audio:AudioMixer"),d=function(){function t(e){Object(s.a)(this,t),this._clips=new Map,this.userInteraction=e(a.a)}return Object(r.a)(t,[{key:"init",value:function(){this.userInteraction.registerInteractionCallback((function(){p("initialized audio"),new u.Howl({src:["data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU2LjM2LjEwMAAAAAAAAAAAAAAA//OEAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAEAAABIADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV6urq6urq6urq6urq6urq6urq6urq6urq6v////////////////////////////////8AAAAATGF2YzU2LjQxAAAAAAAAAAAAAAAAJAAAAAAAAAAAASDs90hvAAAAAAAAAAAAAAAAAAAA//MUZAAAAAGkAAAAAAAAA0gAAAAATEFN//MUZAMAAAGkAAAAAAAAA0gAAAAARTMu//MUZAYAAAGkAAAAAAAAA0gAAAAAOTku//MUZAkAAAGkAAAAAAAAA0gAAAAANVVV"],formats:["mp3"],html5:!1}).play()}))}},{key:"registerAudio",value:function(t,e){var o=this._clips.get(t);o&&o.stop(),this._clips.set(t,e)}},{key:"unregisterAudio",value:function(t,e){this._clips.get(t)===e&&this._clips.delete(t)}},{key:"getAudio",value:function(t){return this._clips.get(t)}}]),t}(),l=o(9),y=["play","end","pause"],f=function(){function t(e){Object(s.a)(this,t),this.audioMixer=e(d),this.virtualMachine=e(l.b)}return Object(r.a)(t,[{key:"init",value:function(t,e){var o=this;this.interpreter=t;this.SOUND=t.createNativeFunction((function(){throw new Error("Cannot construct Sound object, use Sound.get")}),!0),t.setProperty(this.SOUND,"prototype",t.createObject(e.properties.EventTarget),l.a.NONENUMERABLE_DESCRIPTOR),this.SOUND_PROTO=this.SOUND.properties.prototype,t.setProperty(e,"Sound",this.SOUND);t.setProperty(this.SOUND,"get",t.createNativeFunction((function(t){if("string"!==typeof t)throw new TypeError("id must be a string");var e=o.audioMixer.getAudio(t);if(e){y.forEach((function(t){e.sound.on(t,(function(){o.virtualMachine.dispatchEvent({target:i,type:t})}))}));var i=o.interpreter.createObjectProto(o.SOUND_PROTO);return i.data=e,i}})),l.a.NONENUMERABLE_DESCRIPTOR);t.setNativeFunctionPrototype(this.SOUND,"play",(function(){this.data.play()})),t.setNativeFunctionPrototype(this.SOUND,"pause",(function(){this.data.pause()})),t.setNativeFunctionPrototype(this.SOUND,"stop",(function(){this.data.stop()})),t.setNativeFunctionPrototype(this.SOUND,"seek",(function(t){if(t=Number(t),isNaN(t))throw new TypeError("time must be a valid number");if(t<0)throw new RangeError("time must be greater than or equal to 0");this.data.seek(t)})),t.setNativeFunctionPrototype(this.SOUND,"setVolume",(function(t){if(t=Number(t),isNaN(t))throw new TypeError("volume must be a valid number");if(t<0)throw new RangeError("volume must be greater than or equal to 0");if(t>1)throw new RangeError("volume must be less than or equal to 1");this.data.setVolume(t)})),t.setNativeFunctionPrototype(this.SOUND,"destroy",(function(){this.data.destroy()}))}}]),t}(),v=o(75),m=h()("eos:audio:AudioClip"),D=function(){function t(e){var o=e.url,i=e.loops,n=e.volume,A=e.onDestroy;Object(s.a)(this,t),this.url=o,this.loops=i,this.loopsRemaining=i-1,this.onDestroy=A,this.isDestroyed=!1,this.sound=new u.Howl({src:[o],format:["mp3"],volume:n,onend:this.handleEnded.bind(this),html5:!1})}return Object(r.a)(t,[{key:"play",value:function(){this.isDestroyed||(m("playing sound %s",this.url),this.sound.play())}},{key:"pause",value:function(){this.isDestroyed||this.sound.pause()}},{key:"stop",value:function(){this.isDestroyed||(m("stopping sound %s",this.url),this.sound.stop())}},{key:"seek",value:function(t){this.isDestroyed||this.sound.seek(t)}},{key:"setVolume",value:function(t){this.isDestroyed||this.sound.volume(t)}},{key:"destroy",value:function(){this.isDestroyed||(this.stop(),this.isDestroyed=!0,"function"===typeof this.onDestroy&&this.onDestroy())}},{key:"handleEnded",value:function(){this.isDestroyed||this.loopsRemaining>0&&(this.loopsRemaining--,this.sound.play())}}]),t}(),w=function(t){t.host;var e,o=t.deps,i=t.opts,s=i.locator,r=i.loops,u=void 0===r?1:r,a=i.volume,c=void 0===a?1:a,h=i.id,p=i.background,l=o(v.a),y=o(d),f=l.resolveLocator({type:"audio/mpeg",locator:s});return{load:function(){var t=Object(A.a)(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.preload(f);case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),run:function(){(e=new D({url:f.href,loops:0===u?1/0:u,volume:c,onDestroy:h?function(){y.unregisterAudio(h,e)}:null})).play(),h&&y.registerAudio(h,e)},unload:function(){e&&!p&&e.destroy(),l.revoke(f)}}};e.default=function(){var t=Object(A.a)(n.a.mark((function t(e){var o,i;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e(f),e(d).init(),i={playCommand:w},t.abrupt("return",{commands:i,vm:o.init.bind(o)});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}]);
//# sourceMappingURL=5.7295f0c1.chunk.js.map